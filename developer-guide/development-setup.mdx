---
title: "Development Setup"
description: "Get your local development environment running"
---

## Prerequisites

Before starting, ensure you have these tools installed:

| Tool | Version | Purpose |
|------|---------|---------|
| Node.js | 18+ | JavaScript runtime |
| Bun | Latest | Package manager & runtime |
| Docker | Latest | PostgreSQL database |
| Git | Latest | Version control |

## Installation

<Steps>
  <Step title="Clone Repository">
    ```bash
    git clone https://github.com/your-org/lovertoon.git
    cd lovertoon
    ```
  </Step>

  <Step title="Install Dependencies">
    ```bash
    bun install
    ```
  </Step>

  <Step title="Setup Environment">
    Copy the example environment file:
    ```bash
    cp .env.example .env
    ```

    Then edit `.env` with your configuration (see [Environment Variables](/developer-guide/environment-variables)).
  </Step>

  <Step title="Start Database">
    Start PostgreSQL using Docker:
    ```bash
    ./start-database.sh
    ```

    This creates a PostgreSQL container on port 5432.
  </Step>

  <Step title="Run Migrations">
    Apply database schema:
    ```bash
    bun run db:migrate
    ```
  </Step>

  <Step title="Start Development Server">
    ```bash
    bun run dev
    ```

    Open [http://localhost:3000](http://localhost:3000) in your browser.
  </Step>
</Steps>

## Available Scripts

### Development

```bash
# Start dev server with Turbopack
bun run dev

# Start Drizzle Studio (database GUI)
bun run db:studio
# Opens at http://localhost:4983
```

### Database

```bash
# Generate migration from schema changes
bun run db:generate

# Run pending migrations
bun run db:migrate

# Push schema directly (development only)
bun run db:push
```

### Code Quality

```bash
# Run ESLint
bun run lint

# Fix linting issues
bun run lint:fix

# TypeScript type checking
bun run typecheck

# Prettier format check
bun run format:check

# Format and write files
bun run format:write

# Combined lint + typecheck
bun run check
```

### Production

```bash
# Build for production
bun run build

# Start production server
bun run start

# Build + start combined
bun run preview
```

## Environment Configuration

### Required Variables

Create your `.env` file with these required values:

```bash
# Database
DATABASE_URL="postgresql://postgres:password@localhost:5432/lovertoon"

# Authentication
AUTH_SECRET="your-secret-key-at-least-32-chars"
AUTH_URL="http://localhost:3000"

# Google OAuth
AUTH_GOOGLE_ID="your-google-client-id"
AUTH_GOOGLE_SECRET="your-google-client-secret"

# Stripe
STRIPE_SECRET_KEY="sk_test_..."
STRIPE_WEBHOOK_SECRET="whsec_..."

# Cloudflare R2
R2_ACCOUNT_ID="your-account-id"
R2_ACCESS_KEY_ID="your-access-key"
R2_SECRET_ACCESS_KEY="your-secret-key"
R2_BUCKET_NAME="lovertoon"
R2_PUBLIC_DOMAIN="https://cdn.lovertoon.com"

# Email
RESEND_API_KEY="re_..."
```

### Google OAuth Setup

1. Go to [Google Cloud Console](https://console.cloud.google.com/)
2. Create a new project or select existing
3. Enable Google+ API
4. Create OAuth 2.0 credentials
5. Add authorized redirect URI: `http://localhost:3000/api/auth/callback/google`

### Stripe Setup

1. Create account at [Stripe Dashboard](https://dashboard.stripe.com/)
2. Get test API keys from Developers > API keys
3. Set up webhook endpoint for local testing using Stripe CLI:

```bash
# Install Stripe CLI
brew install stripe/stripe-cli/stripe

# Login to Stripe
stripe login

# Forward webhooks to local server
stripe listen --forward-to localhost:3000/api/stripe/webhook
```

### Cloudflare R2 Setup

1. Log in to [Cloudflare Dashboard](https://dash.cloudflare.com/)
2. Navigate to R2 Object Storage
3. Create a bucket named `lovertoon`
4. Generate API tokens with read/write access
5. Configure public access or custom domain

## Database Management

### Drizzle Studio

Visual database management:

```bash
bun run db:studio
```

Opens at [http://localhost:4983](http://localhost:4983) with:
- Table browser
- Data editor
- Query executor

### Schema Changes

When modifying `src/server/db/schema.ts`:

```bash
# 1. Generate migration file
bun run db:generate

# 2. Review generated SQL in drizzle/

# 3. Apply migration
bun run db:migrate
```

<Warning>
Never use `db:push` in production. Always use migrations for schema changes.
</Warning>

## IDE Setup

### VS Code Extensions

Recommended extensions:
- **ESLint** - Linting integration
- **Prettier** - Code formatting
- **Tailwind CSS IntelliSense** - Class autocomplete
- **Prisma** (for Drizzle) - Schema syntax highlighting
- **TypeScript Vue Plugin (Volar)** - Better TypeScript support

### Settings

Add to `.vscode/settings.json`:

```json
{
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": "explicit"
  },
  "typescript.tsdk": "node_modules/typescript/lib"
}
```

## Testing Payments

### Stripe Test Cards

| Card Number | Description |
|-------------|-------------|
| 4242 4242 4242 4242 | Successful payment |
| 4000 0000 0000 0002 | Card declined |
| 4000 0025 0000 3155 | 3D Secure required |

Use any future expiry date and any 3-digit CVC.

### Test Webhook Events

Using Stripe CLI:

```bash
# Trigger test event
stripe trigger checkout.session.completed

# View webhook logs
stripe logs tail
```

## Troubleshooting

<AccordionGroup>
  <Accordion title="Database connection failed">
    Ensure Docker is running and PostgreSQL container is active:
    ```bash
    docker ps
    # Should show lovertoon-postgres container

    # If not running, start it:
    ./start-database.sh
    ```
  </Accordion>

  <Accordion title="Environment validation error">
    Check all required environment variables are set:
    ```bash
    # Verify .env file exists
    cat .env

    # Ensure no syntax errors (no spaces around =)
    DATABASE_URL="value"  # correct
    DATABASE_URL = "value"  # wrong
    ```
  </Accordion>

  <Accordion title="TypeScript errors on fresh install">
    Regenerate types:
    ```bash
    bun run typecheck
    # Or restart TypeScript server in VS Code
    ```
  </Accordion>

  <Accordion title="Stripe webhook not receiving events">
    Ensure Stripe CLI is forwarding:
    ```bash
    stripe listen --forward-to localhost:3000/api/stripe/webhook

    # Copy the webhook signing secret to .env
    STRIPE_WEBHOOK_SECRET="whsec_..."
    ```
  </Accordion>
</AccordionGroup>

## Next Steps

<CardGroup cols={2}>
  <Card title="Architecture" icon="sitemap" href="/developer-guide/architecture-overview">
    Understand the application architecture
  </Card>
  <Card title="Database Schema" icon="database" href="/developer-guide/schema-reference">
    Explore database tables and relationships
  </Card>
</CardGroup>
